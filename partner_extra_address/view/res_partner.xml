<openerp>
    <data>

        <!--Inherit the standard contact popup from 
            base.view_partner_form and add the default option for the selected 
            type
        -->
        <record model="ir.ui.view" id="res_partner_type_selection_view">
            <field name="name">res.partner.type.selectionview</field>
            <field name="model">res.partner</field>
            <field name="inherit_id" ref="base.view_partner_form" />
            <field name="priority" eval="50"/>
            <field name="arch" type="xml">
                <xpath expr="//form[@string='Contact']//field[@name='type']" position="after">
                    <group>
                        <field name="type_default" />
                        <p colspan="4"><i> (Select if this contact will
                            be the default for the selected type.
                            Once selected as default the other contacts of this type will 
                            be reset.)</i>
                        </p>
                    </group>
                </xpath>
                <xpath expr="//field[@name='child_ids']//field[@name='state_id']" position="after">
                <field name="type_default"/>
                </xpath>
                <xpath expr="//field[@name='child_ids']/kanban//table[@class='oe_kanban_table']/tr/td" position="inside">
                    <t t-if="record.type_default.raw_value">
                        <p> <b>
                            Default <field name="type" readonly="1"/> Address
                        </b></p>
                    </t>
                </xpath>

                <!-- TODO order with default addresses before all others
                <xpath expr="//field[@name='child_ids']/kanban" position="attributes">
                    <attribute name="default_group_by">type_default</attribute>
                </xpath>
                -->
            </field>
        </record>

        <!-- Address form to use as pop-up from other views to create/edit
             addresses like sender address or delivery address.
             Parent and address type need to be set by the calling form.
        -->
        <record
            id="simple_address_form"
            model="ir.ui.view"
        >
            <field name="name">res.partner.address.form</field>
            <field name="model">res.partner</field>
            <field name="arch" type="xml">
                <form string="Address">
                    <group col="4">
                        <field
                            name="parent_id"
                            readonly="True"
                        />
                        <field
                            name="type"
                            readonly="True"
                            />

                        <field
                            name="name"
                            required="True"
                        />
                        <field
                            name="type_default"
                        />
                        <field
                            name="street"
                            required="True"
                        />
                        <field name="zip" />
                        <field
                            name="city"
                            required="True"
                        />
                        <field name="country_id" />
                        <field
                            name="email"
                            widget="email"
                            colspan="4"
                        />
                        <field name="phone"/>
                        <field name="mobile"/>
                        <field
                            name="active"
                            string="Keep address available for reuse"
                            help="Sets the active flag on the address"
                        />
                    </group>
                </form>
            </field>
        </record>
    </data>
</openerp>
